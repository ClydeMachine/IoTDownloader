<!DOCTYPE html>
<html>
 <head>
  <title>The Arbiter - You get one of two files to download, which will it be?</title>
  <script src="http://code.jquery.com/jquery-2.0.3.js"></script>
  <script>
  $(document).ready(function(){

  function getURL() {
    $.ajax({
      url: "../cgi-bin/pullFromS3.cgi",
      type: "GET",
      datatype: "html",
      success: function(response){
        if (response.indexOf("NO DOWNLOAD FOR YOU") > -1){
          printableURL = "<div id=\"warning\">There is no file available for download just yet. Leave the page open or check back later!</div>"
        } else if (response.indexOf("1.mp3") > -1) {
          printableURL = "<a id=\"downloadURL\" href='" + response + "'>The first song is available for download! Click here to get this song!</a>"
        } else if (response.indexOf("2.mp3") > -1) {
          printableURL = "<a id=\"downloadURL\" href='" + response + "'>The second song is now available for download! Click to get it now!</a>"
        } else {
          printableURL = "<a id=\"downloadURL\" href='" + response + "'>There is a file available for download! Click here to get the file!</a>"
        }
        $("#FileURLResult").html(printableURL);
        console.log("FileURL read completed.");
      }
    });
  }
  
  var t = getURL() // This is done to make sure the link shows up immediately on pageload, before commencing with the periodic update.
  t = setInterval(getURL,3000); // This makes the page request the URL every three seconds, in case of a deletion or other update.

  }); //End all-encompassing document.ready block. Every element should be put in here to run once the page is loaded.
  </script>
  <style>

#separator {
  font-weight:bold;
  text-align:center;
}

#FileURLResult {
  font-weight:bold;
  text-align:center;
}

#warning {
  color:rgba(102, 0, 0, 1.0);
}

#downloadURL {
  color:rgba(255, 117, 26, 1.0);
}
  </style>

 </head>
 <body>
  <section id="separator">Will you get a file? The below will have a URL if so! Otherwise, it may have a message from the server.</section>
  <section id="separator">.......................................................................................<br /></section>
  <section id="FileURLResult">..Please Wait..<br /></section>
  <section id="separator">.......................................................................................<br /></section>
  </section>
 </body>
</html>
